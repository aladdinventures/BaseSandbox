# User Guide for Aladdin-sandbox Monorepo CI/CD System

## Introduction
This document is a user guide for the Continuous Integration/Continuous Deployment (CI/CD) system implemented in the `aladdin-sandbox` monorepo. The purpose of this guide is to familiarize users with how to interact with the CI/CD system, understand project statuses, and leverage its capabilities to accelerate the development and deployment process.

## 1. Basic CI/CD Concepts

*   **Continuous Integration (CI)**: A development practice where developers frequently integrate their code changes into a shared repository. Each integration is verified by an automated build and tests to detect integration problems as early as possible.
*   **Continuous Deployment (CD)**: A process where code, after successfully passing all CI stages and tests, is automatically deployed to various environments (e.g., Staging and Production).
*   **Monorepo**: A single repository containing multiple distinct projects. Our CI/CD system is designed to manage these projects individually yet cohesively.

## 2. Project Structure and Key Files

*   **`apps/`**: This folder contains all independent projects (e.g., `backend`, `frontend`, `youtube_automation`).
*   **`config/projects.yaml`**: The central configuration file that defines all projects, their build and test commands, and deployment settings for different environments.
*   **`infra/ci-cd/mamos_runner.py`**: The main CI/CD script responsible for executing build, test, and deployment steps for each project.
*   **`.github/workflows/`**: This folder contains GitHub Actions Workflow files (with `.yml` extension) that define the CI/CD execution logic for each project.
*   **`reports/`**: This folder contains reports generated by `mamos_runner.py` after each CI/CD run (`summary.md` and `details/*.md`).

## 3. How to Interact with the CI/CD System

The CI/CD system is automatically triggered with every `push` to the `main` branch (or other configured branches). However, users can also interact with it manually:

### 3.1. Viewing CI/CD Status

1.  **GitHub Actions Dashboard**: Navigate to your GitHub repository and click on the `Actions` tab. Here, you can view a list of all executed Workflows, their statuses (success, failure, in progress), and details of each run.
2.  **Local Reports**: After `mamos_runner.py` runs (either manually or via GitHub Actions), detailed reports are generated in the `aladdin-sandbox/reports/` folder:
    *   `summary.md`: A general overview of the build and test status for all projects.
    *   `details/<project_name>_report.md`: Detailed reports for each project, including the full output of build, test, and deployment steps.

### 3.2. Manually Triggering Workflows

To manually trigger a specific Workflow (e.g., to test a feature or deploy to a specific environment), you can use the `workflow_dispatch` capability in GitHub Actions:

1.  Go to the `Actions` tab in your GitHub repository.
2.  Select the desired Workflow from the left-hand list (e.g., `backend.yml` or `youtube_automation.yml`).
3.  Click on the `Run workflow` button (usually in the top right corner).
4.  In the pop-up window, you can select the target branch and, if available, input parameters (such as project name or deployment environment).
5.  Click `Run workflow` to start the execution.

### 3.3. Manual Approval for Deployment

For sensitive environments like `Staging` and `Production`, the CI/CD system requires manual approval:

1.  After successful completion of build and test steps, the Workflow will reach the manual approval stage.
2.  In the GitHub Actions dashboard, you will see the relevant Workflow run in a `Waiting` status.
3.  Click on the Workflow run to view its details.
4.  In the `Jobs` section, find the deployment Job (e.g., `deploy-staging` or `deploy-production`).
5.  You will see a `Review deployments` button or similar. Click on it.
6.  After review, you can `Approve` or `Reject` the deployment. Approving will allow the Workflow to continue and deployment to proceed.

## 4. Common Troubleshooting

*   **Build or Test Failure**: First, check the detailed project report (`details/<project_name>_report.md`). This report contains the full command output and error messages, which will help identify the root cause of the problem.
*   **Workflow Not Running**: Ensure your changes were `push`ed to the correct branch and that the paths defined in the Workflow (`on: push: paths:`) match your changes.
*   **`401 Client Error: Unauthorized` during Deployment**: This error typically occurs due to a missing or invalid `RENDER_API_KEY` in GitHub Secrets. Contact the system administrator to ensure correct Secrets configuration.

## 5. Support

If you encounter any issues or have questions not covered in this guide, please contact the support team or system administrator.
